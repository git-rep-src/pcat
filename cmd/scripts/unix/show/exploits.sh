# os:0
# raw:0
# one:1
# out:1
export LC_ALL=C
BUF=""
RET=""
xml()
{
    if [ "$1" = "OPEN" ]; then
        BUF="$BUF<$2>"
    elif [ "$1" = "CLOSE" ]; then
        BUF="$BUF</$2>"
    else
        BUF="$BUF<$1>$2</$1>"
    fi
}
xml "OPEN" "DATA type='show' name='exploits'"
xml "OPEN" "KERNEL"
RET=$(uname -o 2>/dev/null)
if [ -n "$RET" ] && [ $? -eq 0 ]; then
    xml "OS" "$RET"
else
    xml "OS" "N/A"
fi
RET=$(uname -a 2>/dev/null | awk '{print $3}' | cut -d '-' -f 1)
if [ -n "$RET" ] && [ $? -eq 0 ]; then
    xml "VERSION" "$RET"
else
    xml "VERSION" "N/A"
fi
RET=$(zcat /proc/config.gz 2>/dev/null)
if [ -n "$RET" ] && [ $? -eq 0 ]; then
    xml "CONFIG" "$RET"
else
    RET=$(cat /boot/config-"$(uname -r)" 2>/dev/null)
    if [ -n "$RET" ] && [ $? -eq 0 ]; then
        xml "CONFIG" "$RET"
    else
        RET=$(cat "${KBUILD_OUTPUT:-/usr/src/linux}"/.config 2>/dev/null)
        if [ -n "$RET" ] && [ $? -eq 0 ]; then
            xml "CONFIG" "$RET"
        else
            xml "CONFIG" "N/A"
        fi
    fi
fi
RET=$(sysctl -a 2>/dev/null)
if [ -n "$RET" ] && [ $? -eq 0 ]; then
    xml "SYSCTL" "$RET"
else
    xml "SYSCTL" "N/A"
fi
RET=$(uname -m 2>/dev/null)
if [ -n "$RET" ] && [ $? -eq 0 ]; then
    xml "ARCH" "$RET"
else
    xml "ARCH" "N/A"
fi
xml "CLOSE" "KERNEL"
xml "CLOSE" "DATA"
printf %b "$BUF [CMD-EOF]"
